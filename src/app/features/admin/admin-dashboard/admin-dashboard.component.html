<div class="p-6 max-w-7xl mx-auto">
  <header class="flex justify-between items-center mb-8">
    <h1 class="text-3xl font-bold text-gray-900">Dashboard Administrativo</h1>
    <button (click)="loadDashboard()" class="btn-primary">
      <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
      </svg>
      Atualizar
    </button>
  </header>

  <div *ngIf="loading" class="text-center py-12">
    <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div>
    <p class="mt-4 text-gray-600">Carregando dados...</p>
  </div>

  <div *ngIf="error" class="mb-6 p-4 bg-error/10 border border-error/20 rounded-lg text-error">
    <p>{{ error }}</p>
  </div>

  <div *ngIf="overview && !loading" class="space-y-6">
    <!-- Account Metrics -->
    <section class="card">
      <h2 class="text-2xl font-semibold text-gray-900 mb-6 pb-3 border-b border-gray-200">Métricas da Conta</h2>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div class="bg-gray-50 rounded-lg p-6 text-center hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-gray-600 mb-2">Clientes</h3>
          <p class="text-3xl font-bold text-gray-900">{{ overview.account_metrics.total_customers }}</p>
          <p class="text-sm text-gray-500 mt-2">{{ overview.account_metrics.active_customers }} ativos</p>
        </div>
        <div class="bg-gray-50 rounded-lg p-6 text-center hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-gray-600 mb-2">Produtos</h3>
          <p class="text-3xl font-bold text-gray-900">{{ overview.account_metrics.total_products }}</p>
          <p class="text-sm text-gray-500 mt-2">{{ overview.account_metrics.active_products }} ativos</p>
        </div>
        <div class="bg-gray-50 rounded-lg p-6 text-center hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-gray-600 mb-2">Assinaturas</h3>
          <p class="text-3xl font-bold text-gray-900">{{ overview.account_metrics.total_subscriptions }}</p>
          <p class="text-sm text-gray-500 mt-2">{{ overview.account_metrics.active_subscriptions }} ativas</p>
        </div>
      </div>
    </section>

    <!-- Leads Metrics -->
    <section *ngIf="overview.leads_metrics" class="card">
      <div class="flex justify-between items-center mb-6 pb-3 border-b border-gray-200">
        <h2 class="text-2xl font-semibold text-gray-900">Métricas de Leads</h2>
        <a routerLink="/admin/customers" class="text-primary hover:text-primary-dark text-sm font-medium">
          Ver Clientes →
        </a>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <div class="bg-gray-50 rounded-lg p-6 text-center hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-gray-600 mb-2">Total de Leads</h3>
          <p class="text-3xl font-bold text-gray-900">{{ overview.leads_metrics.total_leads }}</p>
        </div>
        <div class="bg-gray-50 rounded-lg p-6 text-center hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-gray-600 mb-2">Total de Clientes</h3>
          <p class="text-3xl font-bold text-primary">{{ overview.leads_metrics.total_customers }}</p>
        </div>
        <div class="bg-gray-50 rounded-lg p-6 text-center hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-gray-600 mb-2">Leads Convertidos</h3>
          <p class="text-3xl font-bold text-success">{{ overview.leads_metrics.converted_leads }}</p>
        </div>
        <div class="bg-gradient-to-br from-primary to-primary-dark rounded-lg p-6 text-center text-white hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-white/90 mb-2">Taxa de Conversão</h3>
          <p class="text-3xl font-bold">{{ formatPercentage(overview.leads_metrics.conversion_rate) }}</p>
        </div>
      </div>
    </section>

    <!-- Today Summary -->
    <section class="card">
      <h2 class="text-2xl font-semibold text-gray-900 mb-6 pb-3 border-b border-gray-200">Hoje</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <div class="bg-gray-50 rounded-lg p-6 text-center hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-gray-600 mb-2">Agendadas</h3>
          <p class="text-3xl font-bold text-gray-900">{{ overview.today_summary.scheduled_deliveries }}</p>
        </div>
        <div class="bg-gray-50 rounded-lg p-6 text-center hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-gray-600 mb-2">Concluídas</h3>
          <p class="text-3xl font-bold text-success">{{ overview.today_summary.completed_deliveries }}</p>
        </div>
        <div class="bg-gray-50 rounded-lg p-6 text-center hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-gray-600 mb-2">Pendentes</h3>
          <p class="text-3xl font-bold text-warning">{{ overview.today_summary.pending_deliveries }}</p>
        </div>
        <div class="bg-gray-50 rounded-lg p-6 text-center hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-gray-600 mb-2">Falhas</h3>
          <p class="text-3xl font-bold text-error">{{ overview.today_summary.failed_deliveries }}</p>
        </div>
        <div class="bg-gradient-to-br from-primary to-primary-dark rounded-lg p-6 text-center text-white hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-white/90 mb-2">Receita Esperada</h3>
          <p class="text-3xl font-bold">{{ formatCurrency(overview.today_summary.expected_revenue, overview.today_summary.currency) }}</p>
        </div>
        <div class="bg-gradient-to-br from-primary to-primary-dark rounded-lg p-6 text-center text-white hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-white/90 mb-2">Receita Coletada</h3>
          <p class="text-3xl font-bold">{{ formatCurrency(overview.today_summary.collected_revenue, overview.today_summary.currency) }}</p>
        </div>
      </div>
    </section>

    <!-- Week Summary -->
    <section class="card">
      <h2 class="text-2xl font-semibold text-gray-900 mb-6 pb-3 border-b border-gray-200">Esta Semana</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <div class="bg-gray-50 rounded-lg p-6 text-center hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-gray-600 mb-2">Total de Entregas</h3>
          <p class="text-3xl font-bold text-gray-900">{{ overview.week_summary.total_deliveries }}</p>
        </div>
        <div class="bg-gray-50 rounded-lg p-6 text-center hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-gray-600 mb-2">Taxa de Sucesso</h3>
          <p class="text-3xl font-bold text-gray-900">{{ formatPercentage(overview.week_summary.success_rate) }}</p>
        </div>
        <div class="bg-gradient-to-br from-primary to-primary-dark rounded-lg p-6 text-center text-white hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-white/90 mb-2">Receita Total</h3>
          <p class="text-3xl font-bold">{{ formatCurrency(overview.week_summary.total_revenue, overview.week_summary.currency) }}</p>
        </div>
        <div class="bg-gradient-to-br from-primary to-primary-dark rounded-lg p-6 text-center text-white hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-white/90 mb-2">Média Diária</h3>
          <p class="text-3xl font-bold">{{ formatCurrency(overview.week_summary.average_daily_revenue, overview.week_summary.currency) }}</p>
        </div>
      </div>
    </section>

    <!-- Month Summary -->
    <section class="card">
      <h2 class="text-2xl font-semibold text-gray-900 mb-6 pb-3 border-b border-gray-200">Este Mês</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <div class="bg-gray-50 rounded-lg p-6 text-center hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-gray-600 mb-2">Total de Entregas</h3>
          <p class="text-3xl font-bold text-gray-900">{{ overview.month_summary.total_deliveries }}</p>
        </div>
        <div class="bg-gray-50 rounded-lg p-6 text-center hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-gray-600 mb-2">Taxa de Sucesso</h3>
          <p class="text-3xl font-bold text-gray-900">{{ formatPercentage(overview.month_summary.success_rate) }}</p>
        </div>
        <div class="bg-gradient-to-br from-primary to-primary-dark rounded-lg p-6 text-center text-white hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-white/90 mb-2">Receita Total</h3>
          <p class="text-3xl font-bold">{{ formatCurrency(overview.month_summary.total_revenue, overview.month_summary.currency) }}</p>
        </div>
        <div class="bg-gradient-to-br from-primary to-primary-dark rounded-lg p-6 text-center text-white hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-white/90 mb-2">Receita Coletada</h3>
          <p class="text-3xl font-bold">{{ formatCurrency(overview.month_summary.collected_revenue, overview.month_summary.currency) }}</p>
        </div>
        <div class="bg-gray-50 rounded-lg p-6 text-center hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-gray-600 mb-2">Receita Pendente</h3>
          <p class="text-3xl font-bold text-warning">{{ formatCurrency(overview.month_summary.pending_revenue, overview.month_summary.currency) }}</p>
        </div>
        <div class="bg-gray-50 rounded-lg p-6 text-center hover:shadow-lg transition-shadow">
          <h3 class="text-sm font-medium text-gray-600 mb-2">Crescimento</h3>
          <p class="text-3xl font-bold" [ngClass]="overview.month_summary.growth_percentage >= 0 ? 'text-success' : 'text-error'">
            {{ formatPercentage(overview.month_summary.growth_percentage) }}
          </p>
        </div>
      </div>
    </section>

    <footer class="text-center py-4 text-gray-600 text-sm">
      <p>Última atualização: {{ overview.last_updated | date:'short' }}</p>
    </footer>
  </div>
</div>
